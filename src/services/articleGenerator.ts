export interface GeneratedArticle {
  title: string;
  content: string;
  imageUrl: string;
  category: string;
  tags: string[];
  publishedAt: string;
  author: string;
  excerpt: string;
}

export interface ArticlePrompt {
  topic: string;
  videoUrl?: string;
  category?: string;
}

class ArticleGeneratorService {
  private readonly TOPICS = [
    {
      topic: "–ö–∞–∫ —Å–æ–∑–¥–∞—Ç—å —É–º–Ω–æ–≥–æ –ø–æ–º–æ—â–Ω–∏–∫–∞ –¥–ª—è –¥–æ–º–∞ —Å –ø–æ–º–æ—â—å—é ChatGPT –∏ Telegram",
      category: "–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è",
      videoUrl: "https://youtu.be/example1"
    },
    {
      topic: "–°–µ–∫—Ä–µ—Ç—ã —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–≥–æ –ø—Ä–æ–º–ø—Ç–∏–Ω–≥–∞: –ö–∞–∫ –ø–æ–ª—É—á–∏—Ç—å –º–∞–∫—Å–∏–º—É–º –æ—Ç AI",
      category: "–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏",
      videoUrl: "https://youtu.be/example2"
    },
    {
      topic: "–°–æ–∑–¥–∞–Ω–∏–µ –≥–æ–ª–æ—Å–æ–≤–æ–≥–æ –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–∞ –±–µ–∑ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è",
      category: "No-Code",
      videoUrl: "https://youtu.be/example3"
    },
    {
      topic: "–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è —Ä—É—Ç–∏–Ω–Ω—ã—Ö –∑–∞–¥–∞—á —Å –ø–æ–º–æ—â—å—é n8n –∏ ChatGPT",
      category: "–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è",
      videoUrl: "https://youtu.be/example4"
    },
    {
      topic: "–ö–∞–∫ –∑–∞—Å—Ç–∞–≤–∏—Ç—å ChatGPT —Ä–∞–±–æ—Ç–∞—Ç—å –∫–∞–∫ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –∫–æ—É—á",
      category: "–ü—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—å",
      videoUrl: "https://youtu.be/example5"
    },
    {
      topic: "–°–æ–∑–¥–∞–Ω–∏–µ AI-–±–æ—Ç–∞ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –∏ PDF",
      category: "–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏",
      videoUrl: "https://youtu.be/example6"
    },
    {
      topic: "–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è ChatGPT —Å Google Sheets –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ –æ—Ç—á–µ—Ç–æ–≤",
      category: "–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è",
      videoUrl: "https://youtu.be/example7"
    },
    {
      topic: "–ö–∞–∫ —Å–æ–∑–¥–∞—Ç—å AI-–ø–æ–º–æ—â–Ω–∏–∫–∞ –¥–ª—è –∏–∑—É—á–µ–Ω–∏—è —è–∑—ã–∫–æ–≤",
      category: "–û–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ",
      videoUrl: "https://youtu.be/example8"
    },
    {
      topic: "–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –¥–ª—è —Å–æ—Ü–∏–∞–ª—å–Ω—ã—Ö —Å–µ—Ç–µ–π",
      category: "–ú–∞—Ä–∫–µ—Ç–∏–Ω–≥",
      videoUrl: "https://youtu.be/example9"
    },
    {
      topic: "–°–æ–∑–¥–∞–Ω–∏–µ —É–º–Ω–æ–≥–æ –∫–∞–ª–µ–Ω–¥–∞—Ä—è —Å AI-–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ–º",
      category: "–ü—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—å",
      videoUrl: "https://youtu.be/example10"
    }
  ];

  private readonly PROMPT_TEMPLATE = `
–¶–µ–ª—å: –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Å—Ç–∞—Ç—å—é-—Ç—É—Ç–æ—Ä–∏–∞–ª –¥–ª—è –∞—É–¥–∏—Ç–æ—Ä–∏–∏, –∑–∞–∏–Ω—Ç–µ—Ä–µ—Å–æ–≤–∞–Ω–Ω–æ–π –≤ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏/—Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—è—Ö, –Ω–∞–ø–∏—Å–∞–Ω–Ω—É—é –≤ –¥—Ä—É–∂–µ–ª—é–±–Ω–æ–º, –≤–æ–≤–ª–µ–∫–∞—é—â–µ–º, –ø–æ—à–∞–≥–æ–≤–æ–º —Å—Ç–∏–ª–µ, —Å —É–ø–æ—Ä–æ–º –Ω–∞ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ.

–¢–µ–º–∞ –°—Ç–∞—Ç—å–∏: {TOPIC}
–°—Å—ã–ª–∫–∞ –Ω–∞ –í–∏–¥–µ–æ: {VIDEO_URL}

–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –¥–ª—è –ò–ò:

‚äö –û–±—â–∏–π –¢–æ–Ω –∏ –°—Ç–∏–ª—å:
‚Ä¢ –î—Ä—É–∂–µ–ª—é–±–Ω—ã–π –∏ –í–æ–≤–ª–µ–∫–∞—é—â–∏–π: –ò—Å–ø–æ–ª—å–∑—É–π –Ω–µ—Ñ–æ—Ä–º–∞–ª—å–Ω–æ–µ –æ–±—Ä–∞—â–µ–Ω–∏–µ ("–ü—Ä–∏–≤–µ—Ç, –¥—Ä—É–∑—å—è!", "—Ç—ã"), —Å–æ–∑–¥–∞–≤–∞–π –æ—â—É—â–µ–Ω–∏–µ –¥–∏–∞–ª–æ–≥–∞.
‚Ä¢ –≠–Ω—Ç—É–∑–∏–∞–∑–º: –ü–æ–¥—á–µ—Ä–∫–∏–≤–∞–π —Ü–µ–Ω–Ω–æ—Å—Ç—å –∏ –∫—Ä—É—Ç–æ—Å—Ç—å –æ–ø–∏—Å—ã–≤–∞–µ–º–æ–≥–æ —Ä–µ—à–µ–Ω–∏—è.
‚Ä¢ –ü—Ä–æ—Å—Ç–æ—Ç–∞ –∏ –î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å: –û–±—ä—è—Å–Ω—è–π —Å–ª–æ–∂–Ω—ã–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏ –ø—Ä–æ—Å—Ç—ã–º —è–∑—ã–∫–æ–º, –∏–∑–±–µ–≥–∞–π –∏–∑–ª–∏—à–Ω–µ–≥–æ –∂–∞—Ä–≥–æ–Ω–∞.
‚Ä¢ –û—Ä–∏–µ–Ω—Ç–∞—Ü–∏—è –Ω–∞ –¥–µ–π—Å—Ç–≤–∏–µ: –ú–æ—Ç–∏–≤–∏—Ä—É–π —á–∏—Ç–∞—Ç–µ–ª—è –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –æ–ø–∏—Å–∞–Ω–Ω–æ–µ.

‚äö –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –°—Ç–∞—Ç—å–∏:
‚Ä¢ –ó–∞–≥–æ–ª–æ–≤–æ–∫: –ö—Ä–∞—Ç–∫–∏–π, —Ü–µ–ø–ª—è—é—â–∏–π, —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —ç–º–æ–¥–∑–∏ (–æ—Ç 1 –¥–æ 3).
‚Ä¢ –í—Å—Ç—É–ø–ª–µ–Ω–∏–µ: –ù–∞—á–∏–Ω–∞–π —Å –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏—è –∏ –≤–æ–ø—Ä–æ—Å–∞, –∑–∞–∏–Ω—Ç—Ä–∏–≥—É–π —á–∏—Ç–∞—Ç–µ–ª—è.
‚Ä¢ –û—Å–Ω–æ–≤–Ω—ã–µ –†–∞–∑–¥–µ–ª—ã (–®–∞–≥–∏): –ö–∞–∂–¥—ã–π —ç—Ç–∞–ø –∫–∞–∫ –æ—Ç–¥–µ–ª—å–Ω—ã–π "–®–∞–≥ N" —Å —ç–º–æ–¥–∑–∏.
‚Ä¢ –ë–ª–æ–∫ "–í–∞–∂–Ω—ã–µ –°–æ–≤–µ—Ç—ã/–ù—é–∞–Ω—Å—ã": –° —ç–º–æ–¥–∑–∏ –∏ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–º–∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è–º–∏.
‚Ä¢ –ë–ª–æ–∫ "–ü—Ä–∏–º–µ—Ä –≤ –î–µ–ª–µ: –°–º–æ—Ç—Ä–∏ –°–∞–º!": –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ —Å —Å—Å—ã–ª–∫–æ–π –Ω–∞ –≤–∏–¥–µ–æ.
‚Ä¢ –ó–∞–∫–ª—é—á–µ–Ω–∏–µ: –ù–∞—á–Ω–∏ —Å –ø–æ–∑–¥—Ä–∞–≤–ª–µ–Ω–∏—è ("–ü–æ–∑–¥—Ä–∞–≤–ª—è—é! üéâ").
‚Ä¢ –•—ç—à—Ç–µ–≥–∏: –û—Ç 8 –¥–æ 15 —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã—Ö —Ö—ç—à—Ç–µ–≥–æ–≤ –≤ –∫–æ–Ω—Ü–µ —Å—Ç–∞—Ç—å–∏.

‚äö –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:
‚Ä¢ –≠–º–æ–¥–∑–∏ –æ—Ä–≥–∞–Ω–∏—á–Ω–æ –≤ —Ç–µ–∫—Å—Ç–µ –¥–ª—è –∂–∏–≤–æ—Å—Ç–∏
‚Ä¢ –ñ–∏—Ä–Ω—ã–π —à—Ä–∏—Ñ—Ç –¥–ª—è –∫–ª—é—á–µ–≤—ã—Ö —Ñ—Ä–∞–∑
‚Ä¢ –ö—Ä–∞—Ç–∫–∏–µ, —è—Å–Ω—ã–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è
‚Ä¢ –ü—Ä–∏–∑—ã–≤—ã –∫ –¥–µ–π—Å—Ç–≤–∏—é: "–ì–æ—Ç–æ–≤—ã?", "–ü–æ–µ—Ö–∞–ª–∏!", "–ü—Ä–µ–¥—Å—Ç–∞–≤—å—Ç–µ!"

–°–æ–∑–¥–∞–π –ø–æ–ª–Ω—É—é —Å—Ç–∞—Ç—å—é —Å–ª–µ–¥—É—è —ç—Ç–æ–º—É —à–∞–±–ª–æ–Ω—É!
`;

  async generateArticle(prompt?: ArticlePrompt): Promise<GeneratedArticle> {
    // –ï—Å–ª–∏ –ø—Ä–æ–º–ø—Ç –Ω–µ –ø–µ—Ä–µ–¥–∞–Ω, –≤—ã–±–∏—Ä–∞–µ–º —Å–ª—É—á–∞–π–Ω—É—é —Ç–µ–º—É
    const selectedPrompt = prompt || this.getRandomTopic();
    
    try {
      // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Å—Ç–∞—Ç—å—é —Å –ø–æ–º–æ—â—å—é AI
      const generatedContent = await this.callAIForArticle(selectedPrompt);
      
      // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–ª—è —Å—Ç–∞—Ç—å–∏
      const imageUrl = await this.generateImage(selectedPrompt.topic);
      
      // –ò–∑–≤–ª–µ–∫–∞–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫ –∏–∑ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
      const title = this.extractTitle(generatedContent) || selectedPrompt.topic;
      
      // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º excerpt
      const excerpt = this.generateExcerpt(generatedContent);
      
      // –ò–∑–≤–ª–µ–∫–∞–µ–º —Ç–µ–≥–∏
      const tags = this.extractTags(generatedContent);
      
      return {
        title,
        content: generatedContent,
        imageUrl,
        category: selectedPrompt.category || '–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏',
        tags,
        publishedAt: new Date().toISOString(),
        author: 'AI Hub Team',
        excerpt
      };
    } catch (error) {
      console.error('–û—à–∏–±–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Å—Ç–∞—Ç—å–∏:', error);
      throw new Error('–ù–µ —É–¥–∞–ª–æ—Å—å —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Å—Ç–∞—Ç—å—é');
    }
  }

  private getRandomTopic(): ArticlePrompt {
    const randomIndex = Math.floor(Math.random() * this.TOPICS.length);
    return this.TOPICS[randomIndex];
  }

  private async callAIForArticle(prompt: ArticlePrompt): Promise<string> {
    // –§–æ—Ä–º–∏—Ä—É–µ–º –ø—Ä–æ–º–ø—Ç –¥–ª—è AI
    const aiPrompt = this.PROMPT_TEMPLATE
      .replace('{TOPIC}', prompt.topic)
      .replace('{VIDEO_URL}', prompt.videoUrl || 'https://youtu.be/example');

    // –ó–¥–µ—Å—å –º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º —Ç–æ—Ç –∂–µ —Å–µ—Ä–≤–∏—Å, —á—Ç–æ –∏ –¥–ª—è —á–∞—Ç–∞
    const { sendMessageToAI } = await import('./chatService');
    
    try {
      const response = await sendMessageToAI(
        aiPrompt,
        [], // –ü—É—Å—Ç–∞—è –∏—Å—Ç–æ—Ä–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π
        'qwen3' // –ò—Å–ø–æ–ª—å–∑—É–µ–º Qwen –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Å—Ç–∞—Ç–µ–π
      );
      
      return response;
    } catch (error) {
      console.error('–û—à–∏–±–∫–∞ –≤—ã–∑–æ–≤–∞ AI –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Å—Ç–∞—Ç—å–∏:', error);
      
      // Fallback - –≤–æ–∑–≤—Ä–∞—â–∞–µ–º —à–∞–±–ª–æ–Ω —Å—Ç–∞—Ç—å–∏
      return this.generateFallbackArticle(prompt);
    }
  }

  private async generateImage(topic: string): Promise<string> {
    // –°–ø–∏—Å–æ–∫ —Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —Å Pexels
    const imageCategories = {
      '—Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏': [
        'https://images.pexels.com/photos/8386440/pexels-photo-8386440.jpeg?auto=compress&cs=tinysrgb&w=800&h=400',
        'https://images.pexels.com/photos/8386422/pexels-photo-8386422.jpeg?auto=compress&cs=tinysrgb&w=800&h=400',
        'https://images.pexels.com/photos/3861969/pexels-photo-3861969.jpeg?auto=compress&cs=tinysrgb&w=800&h=400'
      ],
      '–∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è': [
        'https://images.pexels.com/photos/3861458/pexels-photo-3861458.jpeg?auto=compress&cs=tinysrgb&w=800&h=400',
        'https://images.pexels.com/photos/2599244/pexels-photo-2599244.jpeg?auto=compress&cs=tinysrgb&w=800&h=400'
      ],
      '–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ': [
        'https://images.pexels.com/photos/5428836/pexels-photo-5428836.jpeg?auto=compress&cs=tinysrgb&w=800&h=400',
        'https://images.pexels.com/photos/4144923/pexels-photo-4144923.jpeg?auto=compress&cs=tinysrgb&w=800&h=400'
      ],
      '–ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—å': [
        'https://images.pexels.com/photos/3184360/pexels-photo-3184360.jpeg?auto=compress&cs=tinysrgb&w=800&h=400',
        'https://images.pexels.com/photos/3184465/pexels-photo-3184465.jpeg?auto=compress&cs=tinysrgb&w=800&h=400'
      ]
    };

    // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –∫–∞—Ç–µ–≥–æ—Ä–∏—é –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ç–µ–º—ã
    const topicLower = topic.toLowerCase();
    let category = '—Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏'; // –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é

    if (topicLower.includes('–∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è') || topicLower.includes('—Ä–æ–±–æ—Ç')) {
      category = '–∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è';
    } else if (topicLower.includes('–æ–±—É—á–µ–Ω–∏–µ') || topicLower.includes('–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ')) {
      category = '–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ';
    } else if (topicLower.includes('–ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—å') || topicLower.includes('–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ')) {
      category = '–ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—å';
    }

    const images = imageCategories[category as keyof typeof imageCategories] || imageCategories.—Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏;
    const randomIndex = Math.floor(Math.random() * images.length);
    
    return images[randomIndex];
  }

  private extractTitle(content: string): string | null {
    // –ò—â–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫ –≤ –Ω–∞—á–∞–ª–µ —Å—Ç–∞—Ç—å–∏
    const titleMatch = content.match(/^#\s*(.+)$/m) || 
                      content.match(/^(.+?)(?:\n|$)/);
    
    if (titleMatch) {
      return titleMatch[1].replace(/[#*]/g, '').trim();
    }
    
    return null;
  }

  private generateExcerpt(content: string): string {
    // –£–¥–∞–ª—è–µ–º –∑–∞–≥–æ–ª–æ–≤–∫–∏ –∏ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
    const cleanContent = content
      .replace(/^#.+$/gm, '') // –£–¥–∞–ª—è–µ–º –∑–∞–≥–æ–ª–æ–≤–∫–∏
      .replace(/\*\*(.+?)\*\*/g, '$1') // –£–±–∏—Ä–∞–µ–º –∂–∏—Ä–Ω—ã–π —Ç–µ–∫—Å—Ç
      .replace(/[#*`]/g, '') // –£–¥–∞–ª—è–µ–º markdown —Å–∏–º–≤–æ–ª—ã
      .replace(/\n+/g, ' ') // –ó–∞–º–µ–Ω—è–µ–º –ø–µ—Ä–µ–Ω–æ—Å—ã —Å—Ç—Ä–æ–∫ –Ω–∞ –ø—Ä–æ–±–µ–ª—ã
      .replace(/\s+/g, ' ') // –£–±–∏—Ä–∞–µ–º –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–µ–ª—ã
      .trim();
    
    // –ë–µ—Ä–µ–º –ø–µ—Ä–≤—ã–µ 200 —Å–∏–º–≤–æ–ª–æ–≤
    if (cleanContent.length <= 200) {
      return cleanContent;
    }
    
    const truncated = cleanContent.substring(0, 200);
    const lastSpaceIndex = truncated.lastIndexOf(' ');
    
    if (lastSpaceIndex > 160) {
      return truncated.substring(0, lastSpaceIndex).trim() + '...';
    }
    
    return truncated.trim() + '...';
  }

  private extractTags(content: string): string[] {
    const text = content.toLowerCase();
    const tags: string[] = [];
    
    // –ò–∑–≤–ª–µ–∫–∞–µ–º —Ö—ç—à—Ç–µ–≥–∏ –∏–∑ –∫–æ–Ω—Ü–∞ —Å—Ç–∞—Ç—å–∏
    const hashtagMatch = content.match(/#[\w–ê-–Ø–∞-—è]+/g);
    if (hashtagMatch) {
      tags.push(...hashtagMatch.map(tag => tag.substring(1)));
    }
    
    // –î–æ–±–∞–≤–ª—è–µ–º —Ç–µ–≥–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤
    if (text.includes('chatgpt') || text.includes('—á–∞—Çgpt')) tags.push('ChatGPT');
    if (text.includes('ai') || text.includes('–∏–∏') || text.includes('–∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω—ã–π –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç')) tags.push('AI');
    if (text.includes('—Ä–æ–±–æ—Ç') || text.includes('–±–æ—Ç')) tags.push('–†–æ–±–æ—Ç—ã');
    if (text.includes('no-code') || text.includes('–±–µ–∑ –∫–æ–¥–∞')) tags.push('NoCode');
    if (text.includes('–∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è')) tags.push('–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è');
    if (text.includes('telegram')) tags.push('Telegram');
    if (text.includes('n8n')) tags.push('n8n');
    if (text.includes('–ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—å')) tags.push('–ü—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—å');
    
    // –£–¥–∞–ª—è–µ–º –¥—É–±–ª–∏–∫–∞—Ç—ã –∏ –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ
    return [...new Set(tags)].slice(0, 10);
  }

  private generateFallbackArticle(prompt: ArticlePrompt): string {
    return `
# üöÄ ${prompt.topic}: –†–µ–≤–æ–ª—é—Ü–∏—è –≤ –ú–∏—Ä–µ –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–π!

**–ü—Ä–∏–≤–µ—Ç, –¥—Ä—É–∑—å—è! üëã**

–¢—ã –∫–æ–≥–¥–∞-–Ω–∏–±—É–¥—å –º–µ—á—Ç–∞–ª –æ —Ç–æ–º, —á—Ç–æ–±—ã —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ —Ä–∞–±–æ—Ç–∞–ª–∏ –Ω–∞ —Ç–µ–±—è, –∞ –Ω–µ –Ω–∞–æ–±–æ—Ä–æ—Ç? –°–µ–≥–æ–¥–Ω—è –º—ã —Ä–∞–∑–±–µ—Ä–µ–º –Ω–µ–≤–µ—Ä–æ—è—Ç–Ω—É—é –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å, –∫–æ—Ç–æ—Ä–∞—è –∏–∑–º–µ–Ω–∏—Ç —Ç–≤–æ–π –ø–æ–¥—Ö–æ–¥ –∫ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏!

**–ì–æ—Ç–æ–≤ –æ–∫—É–Ω—É—Ç—å—Å—è –≤ –º–∏—Ä –±—É–¥—É—â–µ–≥–æ? –¢–æ–≥–¥–∞ –ø–æ–µ—Ö–∞–ª–∏! üî•**

---

## –®–∞–≥ 1: üßê –ß—Ç–æ –ó–∞ "–ß—É–¥–æ" –ú—ã –°—Ç—Ä–æ–∏–º?

–ü—Ä–µ–¥—Å—Ç–∞–≤—å —Å–µ–±–µ —Å–∏—Å—Ç–µ–º—É, –∫–æ—Ç–æ—Ä–∞—è:
- –ü–æ–Ω–∏–º–∞–µ—Ç —Ç–≤–æ–∏ –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç–∏
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–ø–æ–ª–Ω—è–µ—Ç —Ä—É—Ç–∏–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏
- –≠–∫–æ–Ω–æ–º–∏—Ç —á–∞—Å—ã —Ç–≤–æ–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ –∫–∞–∂–¥—ã–π –¥–µ–Ω—å
- –†–∞–±–æ—Ç–∞–µ—Ç 24/7 –±–µ–∑ –ø–µ—Ä–µ—Ä—ã–≤–æ–≤

**–ó–≤—É—á–∏—Ç –∫–∞–∫ –º–∞–≥–∏—è? –ù–æ —ç—Ç–æ —Ä–µ–∞–ª—å–Ω–æ—Å—Ç—å!**

---

## –®–∞–≥ 2: üõ† –ü–æ–¥–≥–æ—Ç–∞–≤–ª–∏–≤–∞–µ–º –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã

–î–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –Ω–∞—à–µ–≥–æ —Ä–µ—à–µ–Ω–∏—è –ø–æ–Ω–∞–¥–æ–±–∏—Ç—Å—è:

1. **–ö–æ–º–ø—å—é—Ç–µ—Ä –∏–ª–∏ —Å–º–∞—Ä—Ç—Ñ–æ–Ω** - –¥–∞, –≤—Å—ë —Ç–∞–∫ –ø—Ä–æ—Å—Ç–æ!
2. **–î–æ—Å—Ç—É–ø –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç** - –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ —Å–µ—Ä–≤–∏—Å–∞–º
3. **15 –º–∏–Ω—É—Ç —Å–≤–æ–±–æ–¥–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏** - –±–æ–ª—å—à–µ –Ω–µ –Ω—É–∂–Ω–æ!
4. **–ñ–µ–ª–∞–Ω–∏–µ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å** - —Å–∞–º—ã–π –≤–∞–∂–Ω—ã–π –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç!

---

## –®–∞–≥ 3: üéØ –°–æ–∑–¥–∞–µ–º –†–µ—à–µ–Ω–∏–µ –ü–æ—à–∞–≥–æ–≤–æ

**–≠—Ç–∞–ø 1: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ—Å–Ω–æ–≤—ã**
- –û—Ç–∫—Ä—ã–≤–∞–µ–º –Ω—É–∂–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã
- –°–æ–∑–¥–∞–µ–º –∞–∫–∫–∞—É–Ω—Ç—ã (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
- –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –±–∞–∑–æ–≤—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã

**–≠—Ç–∞–ø 2: –°–æ–µ–¥–∏–Ω—è–µ–º –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã**
- –°–≤—è–∑—ã–≤–∞–µ–º —Å–µ—Ä–≤–∏—Å—ã –º–µ–∂–¥—É —Å–æ–±–æ–π
- –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –¥–µ–π—Å—Ç–≤–∏—è
- –¢–µ—Å—Ç–∏—Ä—É–µ–º —Ä–∞–±–æ—Ç—É —Å–∏—Å—Ç–µ–º—ã

**–≠—Ç–∞–ø 3: –ó–∞–ø—É—Å–∫ –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è**
- –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—é
- –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
- –î–æ—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏

---

## üí° –í–∞–∂–Ω—ã–µ –°–æ–≤–µ—Ç—ã –∏ –ù—é–∞–Ω—Å—ã:

- **–ù–∞—á–∏–Ω–∞–π —Å –ø—Ä–æ—Å—Ç–æ–≥–æ** - –Ω–µ –ø—ã—Ç–∞–π—Å—è —Å—Ä–∞–∑—É –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å –≤—Å—ë
- **–¢–µ—Å—Ç–∏—Ä—É–π –∫–∞–∂–¥—ã–π —à–∞–≥** - —ç—Ç–æ –ø–æ–º–æ–∂–µ—Ç –∏–∑–±–µ–∂–∞—Ç—å –æ—à–∏–±–æ–∫
- **–°–æ—Ö—Ä–∞–Ω—è–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏** - —á—Ç–æ–±—ã –Ω–µ –ø–æ—Ç–µ—Ä—è—Ç—å –ø—Ä–æ–¥–µ–ª–∞–Ω–Ω—É—é —Ä–∞–±–æ—Ç—É
- **–≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∏—Ä—É–π** - –∫–∞–∂–¥–∞—è —Å–∏—Ç—É–∞—Ü–∏—è —É–Ω–∏–∫–∞–ª—å–Ω–∞

---

## üëÄ –ü—Ä–∏–º–µ—Ä –≤ –î–µ–ª–µ: –°–º–æ—Ç—Ä–∏ –°–∞–º!

–•–æ—á–µ—à—å —É–≤–∏–¥–µ—Ç—å –≤—Å—ë –≤ –¥–µ–π—Å—Ç–≤–∏–∏? –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –ø–æ—Å–º–æ—Ç—Ä–∏ —ç—Ç–æ –ø–æ–¥—Ä–æ–±–Ω–æ–µ –≤–∏–¥–µ–æ, –≥–¥–µ —è –ø–æ–∫–∞–∑—ã–≤–∞—é –≤–µ—Å—å –ø—Ä–æ—Ü–µ—Å—Å –æ—Ç –ê –¥–æ –Ø:

üëâ [${prompt.videoUrl || 'https://youtu.be/example'}](${prompt.videoUrl || 'https://youtu.be/example'}) üëà

–í –≤–∏–¥–µ–æ —Ç—ã –Ω–∞–π–¥–µ—à—å:
- –ü–æ—à–∞–≥–æ–≤—É—é –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—é
- –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —Å–æ–≤–µ—Ç—ã
- –û—Ç–≤–µ—Ç—ã –Ω–∞ —á–∞—Å—Ç—ã–µ –≤–æ–ø—Ä–æ—Å—ã
- –ë–æ–Ω—É—Å–Ω—ã–µ –ª–∞–π—Ñ—Ö–∞–∫–∏

---

## –ü–æ–∑–¥—Ä–∞–≤–ª—è—é! üéâ

–¢—ã —Ç–æ–ª—å–∫–æ —á—Ç–æ –æ—Ç–∫—Ä—ã–ª –¥–ª—è —Å–µ–±—è –º–æ—â–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏! –¢–µ–ø–µ—Ä—å —Ä—É—Ç–∏–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏ –±—É–¥—É—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è —Å–∞–º–∏, –∞ —É —Ç–µ–±—è –ø–æ—è–≤–∏—Ç—Å—è –±–æ–ª—å—à–µ –≤—Ä–µ–º–µ–Ω–∏ –¥–ª—è –≤–∞–∂–Ω—ã—Ö –¥–µ–ª.

**–ù–µ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–π—Å—è –Ω–∞ –¥–æ—Å—Ç–∏–≥–Ω—É—Ç–æ–º!** –≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∏—Ä—É–π, —Å–æ–∑–¥–∞–≤–∞–π –Ω–æ–≤—ã–µ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ –∏ –¥–µ–ª–∏—Å—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ —Å –¥—Ä—É–∑—å—è–º–∏.

**–í–ø–µ—Ä–µ–¥ –∫ –Ω–æ–≤—ã–º —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–º –≤—ã—Å–æ—Ç–∞–º! üöÄ‚ú®**

---

#AI #–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è #NoCode #–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ #–ü—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—å #ChatGPT #–†–æ–±–æ—Ç—ã #–ë—É–¥—É—â–µ–µ–£–∂–µ–ó–¥–µ—Å—å #–õ–µ–≥–∫–æ–ò–ü—Ä–æ—Å—Ç–æ #–ò–ò #–ë–µ–∑–ö–æ–¥–∞ #–ò–Ω–Ω–æ–≤–∞—Ü–∏–∏
`;
  }

  // –ú–µ—Ç–æ–¥ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–ø–∏—Å–∫–∞ –≤—Å–µ—Ö –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Ç–µ–º
  getAvailableTopics(): ArticlePrompt[] {
    return [...this.TOPICS];
  }

  // –ú–µ—Ç–æ–¥ –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤–æ–π —Ç–µ–º—ã
  addTopic(topic: ArticlePrompt): void {
    this.TOPICS.push(topic);
  }
}

export const articleGenerator = new ArticleGeneratorService();